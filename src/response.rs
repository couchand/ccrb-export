use std::collections::HashMap;

use serde::Deserialize;

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct Response {
    job_ids: Vec<String>,
    results: Vec<ResponseResult>,
}

impl Response {
    pub fn get_data(&self) -> Vec<Vec<String>> {
        map_response(&self.results[0].result.data.dsr.d_s[0])
    }

    pub fn get_restart_tokens(&self) -> Option<Vec<String>> {
        self.results[0].result.data.dsr.d_s[0].r_t.as_ref().map(|v| v[0].clone())
    }
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct ResponseResult {
    job_id: String,
    result: Result,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct Result {
    data: ResultData,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct ResultData {
    timestamp: String,
    root_activity_id: String,
    descriptor: Descriptor,
    from_cache: bool,
    dsr: Dsr,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Descriptor {
    select: Vec<Select>,
    expressions: Expressions,
    version: usize,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Select {
    kind: usize,
    depth: usize,
    value: String,
    group_keys: Vec<GroupKey>,
    name: String,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct GroupKey {
    source: Source,
    calc: String,
    is_same_as_select: bool,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Source {
    entity: String,
    property: String,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Expressions {
    primary: Primary,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Primary {
    groupings: Vec<Grouping>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Grouping {
    keys: Vec<Key>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Key {
    source: Source,
    select: usize,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Dsr {
    version: usize,
    minor_version: usize,
    d_s: Vec<Ds>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Ds {
    n: String,
    p_h: Vec<Ph>,
    i_c: bool,
    h_a_d: Option<bool>,
    r_t: Option<Vec<Vec<String>>>,
    value_dicts: Option<HashMap<String, Vec<String>>>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Ph {
    d_m0: Vec<Dm0>,
}

#[derive(Deserialize, Debug)]
#[serde(untagged)]
pub enum Dm0 {
    A(Dm0A),
    B(Dm0B),
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Dm0A {
    s: Vec<S>,
    c: Vec<usize>,
    #[serde(rename="Ø")]
    zero: Option<usize>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct S {
    n: String,
    t: usize,
    d_n: Option<String>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Dm0B {
    c: Vec<Value>,
    r: Option<usize>,
    #[serde(rename="Ø")]
    zero: Option<usize>,
}

#[derive(Deserialize, Debug)]
#[serde(untagged)]
pub enum Value {
    Str(String),
    Id(usize),
}

#[cfg(test)]
mod test {
    use super::*;

    const RESPONSE: &str = "{\"jobIds\":[\"e6c39045-0560-40d4-9bbc-f2047e4d4111\"],\"results\":[{\"jobId\":\"e6c39045-0560-40d4-9bbc-f2047e4d4111\",\"result\":{\"data\":{\"timestamp\":\"2021-03-04T16:25:59.326Z\",\"rootActivityId\":\"dda144bd-0337-4d29-ba38-2a755136b233\",\"descriptor\":{\"Select\":[{\"Kind\":1,\"Depth\":0,\"Value\":\"G0\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Unique Id\"},\"Calc\":\"G0\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Unique Id\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G1\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Command\"},\"Calc\":\"G1\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Command1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G2\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Last Name\"},\"Calc\":\"G2\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Last Name1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G3\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"First Name\"},\"Calc\":\"G3\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.First Name1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G4\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rank\"},\"Calc\":\"G4\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Rank1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G5\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Shield No\"},\"Calc\":\"G5\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.ShieldNo\"}],\"Expressions\":{\"Primary\":{\"Groupings\":[{\"Keys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Unique Id\"},\"Select\":0},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Command\"},\"Select\":1},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Last Name\"},\"Select\":2},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"First Name\"},\"Select\":3},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rank\"},\"Select\":4},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Shield No\"},\"Select\":5}],\"Member\":\"DM0\"}]}},\"Version\":2},\"fromCache\":true,\"dsr\":{\"Version\":2,\"MinorVersion\":1,\"DS\":[{\"N\":\"DS0\",\"PH\":[{\"DM0\":[{\"S\":[{\"N\":\"G0\",\"T\":1,\"DN\":\"D0\"},{\"N\":\"G1\",\"T\":1,\"DN\":\"D1\"},{\"N\":\"G2\",\"T\":1,\"DN\":\"D2\"},{\"N\":\"G3\",\"T\":1,\"DN\":\"D3\"},{\"N\":\"G4\",\"T\":1,\"DN\":\"D4\"},{\"N\":\"G5\",\"T\":1,\"DN\":\"D5\"}],\"C\":[0,0,0,0,0,0]},{\"C\":[1,1,1,1,1],\"R\":2},{\"C\":[2,2,2,0,2],\"R\":2},{\"C\":[3,3,3,3],\"R\":18},{\"C\":[4,4,4,4],\"R\":18},{\"C\":[5,5,5,2,5],\"R\":2},{\"C\":[6,6,6,1,6],\"R\":2},{\"C\":[7,7,7,7],\"R\":18},{\"C\":[8,8,8,3,8],\"R\":2},{\"C\":[9,9,9,1,9],\"R\":2},{\"C\":[10,10,10,0,10],\"R\":2},{\"C\":[11,11,11,1,11],\"R\":2},{\"C\":[12,12,12,0,12],\"R\":2},{\"C\":[13,13,13,1,13],\"R\":2},{\"C\":[14,14,14,14],\"R\":18},{\"C\":[15,15,15,0,15],\"R\":2},{\"C\":[16,16,16,16],\"R\":18},{\"C\":[17,17,17,17],\"R\":18},{\"C\":[18,1,18,18,18],\"R\":16},{\"C\":[19,19,19,19],\"R\":18},{\"C\":[20,20,20,20],\"R\":18},{\"C\":[21,21,21,2,5],\"R\":2},{\"C\":[22,22,22,0,21],\"R\":2},{\"C\":[23,23,18,22],\"R\":18},{\"C\":[24,24,23,23],\"R\":18},{\"C\":[25,25,24,24],\"R\":18},{\"C\":[26,26,25,3,25],\"R\":2},{\"C\":[27,27,26,0,26],\"R\":2},{\"C\":[28,28,21,27],\"R\":18},{\"C\":[29,29,18,28],\"R\":18},{\"C\":[30,30,27,29],\"R\":18},{\"C\":[31,31,28,30],\"R\":18},{\"C\":[32,32,21,2,5],\"R\":2},{\"C\":[33,33,0,31],\"R\":10},{\"C\":[34,34,29,3,32],\"R\":2},{\"C\":[35,35,30,0,33],\"R\":2},{\"C\":[36,36,31,34],\"R\":18},{\"C\":[37,37,4,35],\"R\":18},{\"C\":[38,38,26,36],\"R\":18},{\"C\":[39,39,32,37],\"R\":18},{\"C\":[40,40,18,38],\"R\":18},{\"C\":[41,41,33,39],\"R\":18},{\"C\":[42,42,34,3,40],\"R\":2},{\"C\":[43,43,35,0,41],\"R\":2},{\"C\":[44,44,11,42],\"R\":18},{\"C\":[45,45,27,43],\"R\":18},{\"C\":[46,46,3,44],\"R\":10},{\"C\":[47,47,36,0,45],\"R\":2},{\"C\":[48,48,37,2,5],\"R\":2},{\"C\":[49,49,38,0,46],\"R\":2},{\"C\":[50,50,39,47],\"R\":18},{\"C\":[51,51,40,48],\"R\":18},{\"C\":[52,52,41,49],\"R\":18},{\"C\":[53,53,42,3,50],\"R\":2},{\"C\":[54,54,27,0,51],\"R\":2},{\"C\":[55,55,43,52],\"R\":18},{\"C\":[56,56,27,53],\"R\":18},{\"C\":[57,57,25,54],\"R\":18},{\"C\":[58,58,44,55],\"R\":18},{\"C\":[59,59,27,3,56],\"R\":2},{\"C\":[60,60,45,0,57],\"R\":2},{\"C\":[61,61,46,58],\"R\":18},{\"C\":[62,62,27,59],\"R\":18},{\"C\":[63,63,18,3,60],\"R\":2},{\"C\":[64,64,47,0,61],\"R\":2},{\"C\":[65,65,18,62],\"R\":18},{\"C\":[66,66,48,63],\"R\":18},{\"C\":[67,67,27,3,64],\"R\":2},{\"C\":[68,68,46,0,65],\"R\":2},{\"C\":[69,69,49,3,66],\"R\":2},{\"C\":[70,70,50,0,67],\"R\":2},{\"C\":[71,0,68],\"R\":22},{\"C\":[72,71,51,69],\"R\":18},{\"C\":[73,72,52,70],\"R\":18},{\"C\":[74,73,53,71],\"R\":18},{\"C\":[75,74,54,72],\"R\":18},{\"C\":[76,75,44,73],\"R\":18},{\"C\":[77,76,55,74],\"R\":18},{\"C\":[78,77,56,75],\"R\":18},{\"C\":[79,78,57,76],\"R\":18},{\"C\":[80,79,58,77],\"R\":18},{\"C\":[81,80,35,78],\"R\":18},{\"C\":[82,81,59,79],\"R\":18},{\"C\":[83,82,21,80],\"R\":18},{\"C\":[84,83,60,81],\"R\":18},{\"C\":[85,84,61,3,82],\"R\":2},{\"C\":[86,85,35,0,83],\"R\":2},{\"C\":[87,86,62,84],\"R\":18},{\"C\":[88,87,63,85],\"R\":18},{\"C\":[89,88,18,86],\"R\":18},{\"C\":[90,64,87],\"R\":22},{\"C\":[91,89,61,88],\"R\":18},{\"C\":[92,90,21,89],\"R\":18},{\"C\":[93,91,65,90],\"R\":18},{\"C\":[94,92,66,91],\"R\":18},{\"C\":[95,93,67,92],\"R\":18},{\"C\":[96,94,68,93],\"R\":18},{\"C\":[97,95,69,94],\"R\":18},{\"C\":[98,96,70,95],\"R\":18},{\"C\":[99,97,61,96],\"R\":18},{\"C\":[\"12345\",98,71,97],\"R\":18},{\"C\":[\"12345\",99,72,3,98],\"R\":2},{\"C\":[\"12345\",\"Lorem\",73,0,99],\"R\":2},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",74,\"12345\"],\"R\":18},{\"C\":[\"12345\",75,\"12345\"],\"R\":22},{\"C\":[\"12345\",76,2,5],\"R\":6},{\"C\":[\"12345\",\"Lorem\",77,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",78,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",79,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",80,\"12345\"],\"R\":18},{\"C\":[\"12345\",81,\"12345\"],\"R\":22},{\"C\":[\"12345\",26,\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",82,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",9,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",83,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",84,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",27,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",85,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",86,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",87,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",27,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",9,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",88,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",26,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",89,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",90,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",0,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",91,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",9,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",92,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",93,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",61,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",94,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",95,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",96,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",97,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",36,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",98,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",99,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",29,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",3,\"12345\"],\"R\":6},{\"C\":[\"12345\",\"Lorem\",47,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",9,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",46,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",54,\"12345\"],\"R\":18},{\"C\":[\"12345\",9,4,5],\"R\":6},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",27,2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",21,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",26,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",4,5],\"R\":6},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",42,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",35,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",54,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",2,\"Lorem\",\"Ipsum\",\"12345\"],\"R\":16},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",50,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",11,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",18,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",35,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",11,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",27,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",18,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",3,\"Lorem\",\"Ipsum\",0,\"12345\"]},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",27,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",61,2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\"],\"R\":50},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",21,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",72,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",35,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",0,\"12345\"],\"R\":6},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",47,\"Lorem\",\"12345\"],\"R\":18},{\"C\":[\"12345\",27,3,\"12345\"],\"R\":6},{\"C\":[\"12345\",\"Lorem\",0,\"12345\"],\"R\":6},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",1,\"12345\"],\"R\":6},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",54,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",9,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",59,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",60,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",72,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Fu\",52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",4,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",94,\"Lorem\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",59,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lee\",25,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",27,2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",4,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",62,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",26,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",97,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",27,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",87,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",33,4,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",52,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",4,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",26,\"12345\"],\"R\":18},{\"C\":[\"12345\",4,\"Lorem\",\"Ipsum\",1,\"12345\"]},{\"C\":[\"12345\",\"Lorem\",18,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",9,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",79,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",5,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",72,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",4,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",26,\"12345\"],\"R\":18},{\"C\":[\"12345\",5,\"Lorem\",\"Ipsum\",\"12345\"],\"R\":16},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",36,\"Lorem\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",26,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",15,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",54,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",51,27,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",61,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",90,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",9,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",35,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",36,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",6,52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",93,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",9,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",52,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",29,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",27,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",11,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",4,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",36,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lee\",80,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"12345\"],\"R\":22},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",9,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",29,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",46,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",60,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",61,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",18,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",61,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",36,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",54,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",72,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",0,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Re\",36,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",21,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",60,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",9,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",60,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",14,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",15,4,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",18,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",21,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",79,2,5],\"R\":2},{\"C\":[\"12345\",\"Lorem\",60,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",21,0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",60,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",5,\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Wu\",46,3,\"12345\"],\"R\":2},{\"C\":[\"12345\",6,\"Lorem\",5,0,\"12345\"]},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",0,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",4,1,\"12345\"],\"R\":2},{\"C\":[\"12345\",\"Lorem\",\"Ipsum\",\"12345\"],\"R\":18},{\"C\":[\"12345\",\"Lorem\",26,\"12345\"],\"R\":18}]}],\"IC\":false,\"RT\":[[\"'007 DET'\",\"'001133'\",\"'Isolano'\",\"'Nicholas'\",\"'Detective'\",\"'00545'\"]],\"ValueDicts\":{\"D0\":[\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\"],\"D1\":[\"001 DET\",\"001 PCT\",\"005 DET\",\"005 PCT\",\"006 DET\",\"006 PCT\",\"007 DET\"],\"D2\":[\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\"],\"D3\":[\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\"],\"D4\":[\"Police Officer\",\"Lorem\",\"Ipsum\",\"Lorem\",\"Ipsum\"],\"D5\":[\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\",\"12345\"]}}]}}}}]}";

    const DETAILS: &str = "{\"jobIds\":[\"b58ea924-0e62-44ac-87c9-f41461352146\"],\"results\":[{\"jobId\":\"b58ea924-0e62-44ac-87c9-f41461352146\",\"result\":{\"data\":{\"timestamp\":\"2021-03-05T03:59:40.632Z\",\"rootActivityId\":\"113f6a96-ac8f-4177-b112-d766345683b2\",\"descriptor\":{\"Select\":[{\"Kind\":1,\"Depth\":0,\"Value\":\"G0\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rn\"},\"Calc\":\"G0\",\"IsSameAsSelect\":true}],\"Name\":\"Sum(Query1.Rn)\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G1\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Complaint ID\"},\"Calc\":\"G1\",\"IsSameAsSelect\":true}],\"Name\":\"CountNonNull(Query1.Complaint Id)1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G2\",\"Format\":\"MM/dd/yyyy\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Incident Date\"},\"Calc\":\"G2\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Incident Date\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G3\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"FADO Type\"},\"Calc\":\"G3\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.FADO Type1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G4\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Allegation\"},\"Calc\":\"G4\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Allegation1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G5\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Board Disposition\"},\"Calc\":\"G5\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Board Disposition1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G6\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"NYPD Disposition\"},\"Calc\":\"G6\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.NYPD Disposition\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G7\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Penalty\"},\"Calc\":\"G7\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.PenaltyDesc1\"}],\"Expressions\":{\"Primary\":{\"Groupings\":[{\"Keys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rn\"},\"Select\":0},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Complaint ID\"},\"Select\":1},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Incident Date\"},\"Select\":2},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"FADO Type\"},\"Select\":3},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Allegation\"},\"Select\":4},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Board Disposition\"},\"Select\":5},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"NYPD Disposition\"},\"Select\":6},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Penalty\"},\"Select\":7}],\"Member\":\"DM0\"}]}},\"Version\":2},\"fromCache\":false,\"dsr\":{\"Version\":2,\"MinorVersion\":1,\"DS\":[{\"N\":\"DS0\",\"PH\":[{\"DM0\":[{\"S\":[{\"N\":\"G0\",\"T\":3},{\"N\":\"G1\",\"T\":1,\"DN\":\"D0\"},{\"N\":\"G2\",\"T\":7},{\"N\":\"G3\",\"T\":1,\"DN\":\"D1\"},{\"N\":\"G4\",\"T\":1,\"DN\":\"D2\"},{\"N\":\"G5\",\"T\":1,\"DN\":\"D3\"},{\"N\":\"G6\",\"T\":1,\"DN\":\"D4\"},{\"N\":\"G7\",\"T\":1,\"DN\":\"D5\"}],\"C\":[1,0,1522722300000,0,0,0],\"Ø\":192},{\"C\":[2,1,1,0,0],\"R\":14},{\"C\":[3,2,2],\"R\":206},{\"C\":[4,3,0],\"R\":14,\"Ø\":192}]}],\"IC\":true,\"HAD\":true,\"ValueDicts\":{\"D0\":[\"201803458\"],\"D1\":[\"Abuse of Authority\"],\"D2\":[\"Pepper spray\",\"Vehicle stop\",\"Vehicle search\",\"Frisk\"],\"D3\":[\"Unsubstantiated\",\"Substantiated (Command Discipline A)\",\"Complaint Withdrawn\"],\"D4\":[\"Formalized Training\"],\"D5\":[\"Formalized Training\"]}}]}}}}]}";

    #[test]
    fn deserialize_response() {

        let model: Response = serde_json::from_str(RESPONSE).expect("deserialize");

        assert_eq!(model.results[0].result.data.descriptor.select[0].group_keys[0].source.entity, "CCRB Active - Oracle");
    }

    #[test]
    fn deserialize_details() {

        let model: Response = serde_json::from_str(DETAILS).expect("deserialize");

        assert_eq!(model.results[0].result.data.descriptor.select[0].group_keys[0].source.entity, "CCRB Active - Oracle");
    }
}

fn map_response(data: &Ds) -> Vec<Vec<String>> {
    let mut result = vec![];

    let value_dicts = match &data.value_dicts {
        None => return vec![],
        Some(v) => v,
    };

    let mut rows = data.p_h.get(0).expect("one row in PH").d_m0.iter();

    let first = rows.next().expect("first row in DM0");

    let (dicts, mut prev) = match first {
        Dm0::A(start) => {
            let dicts = start.s
                .iter()
                .map(|s| {
                    match s.t {
                        3 => {
                            let b: Box<dyn Fn(usize) -> String> = Box::new(|c: usize| c.to_string());
                            b
                        }
                        7 => {
                            // TODO: format date
                            let b: Box<dyn Fn(usize) -> String> = Box::new(|c: usize| {
                                let millis = c;
                                let seconds = millis / 1000;
                                let dt = chrono::NaiveDateTime::from_timestamp(seconds as _, 0);
                                dt.date().format("%Y-%m-%d").to_string()
                            });
                            b
                        }
                        _ => {
                            let dict = value_dicts.get(s.d_n.as_ref().expect("value dict id")).expect("value dict");
                            let b: Box<dyn Fn(usize) -> String> = Box::new(move |c| dict[c].clone());
                            b
                        }
                    }
                })
                .collect::<Vec<Box<dyn Fn(usize) -> String>>>();

            let mut row = vec![];

            let mut items = start.c.iter();

            for i in 0..dicts.len() {
                let mask = start.zero.unwrap_or_default();
                let bit = 1 << i;
                if mask & bit == 0 {
                    let item = items.next().expect("not enough items");
                    row.push(dicts[i](*item));
                }
                else {
                    row.push("".into());
                }
            }

            (dicts, row)
        }
        _ => {
            eprintln!("Expected first row to have full spec");
            return vec![];
        }
    };

    result.push(prev.clone());

    for row in rows {
        let mut accum = prev.clone();

        match row {
            Dm0::B(next) => {
                let mask = next.r.unwrap_or_default();
                let mut values = next.c.iter();

                let zero = next.zero.unwrap_or_default();

                for i in 0..dicts.len() {
                    let bit = 1 << i;

                    if zero & bit != 0 {
                        accum[i] = "".into();
                    }
                    else if mask & bit == 0 {
                        let value = values.next().expect("not enough values");
                        accum[i] = match value {
                            Value::Str(s) => s.clone(),
                            Value::Id(j) => dicts[i](*j),
                        };
                    }
                }
            }
            _ => {
                eprintln!("Expected subsequent row to have differential");
                return result;
            }
        }

        result.push(accum.clone());
        prev = accum;
    }

    return result;
}
