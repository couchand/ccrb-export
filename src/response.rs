use std::collections::HashMap;

use serde::Deserialize;

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct Response {
    job_ids: Vec<String>,
    results: Vec<ResponseResult>,
}

impl Response {
    pub fn get_data(&self) -> Vec<Vec<String>> {
        map_response(&self.results[0].result.data.dsr.d_s[0])
    }

    pub fn get_restart_tokens(&self) -> Option<Vec<String>> {
        self.results[0].result.data.dsr.d_s[0].r_t.as_ref().map(|v| v[0].clone())
    }
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct ResponseResult {
    job_id: String,
    result: Result,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct Result {
    data: ResultData,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="camelCase")]
pub struct ResultData {
    timestamp: String,
    root_activity_id: String,
    descriptor: Descriptor,
    from_cache: bool,
    dsr: Dsr,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Descriptor {
    select: Vec<Select>,
    expressions: Expressions,
    version: usize,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Select {
    kind: usize,
    depth: usize,
    value: String,
    group_keys: Vec<GroupKey>,
    name: String,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct GroupKey {
    source: Source,
    calc: String,
    is_same_as_select: bool,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Source {
    entity: String,
    property: String,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Expressions {
    primary: Primary,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Primary {
    groupings: Vec<Grouping>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Grouping {
    keys: Vec<Key>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Key {
    source: Source,
    select: usize,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Dsr {
    version: usize,
    minor_version: usize,
    d_s: Vec<Ds>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Ds {
    n: String,
    p_h: Vec<Ph>,
    i_c: bool,
    h_a_d: Option<bool>,
    r_t: Option<Vec<Vec<String>>>,
    value_dicts: Option<HashMap<String, Vec<String>>>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Ph {
    d_m0: Vec<Dm0>,
}

#[derive(Deserialize, Debug)]
#[serde(untagged)]
pub enum Dm0 {
    A(Dm0A),
    B(Dm0B),
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Dm0A {
    s: Vec<S>,
    c: Vec<usize>,
    #[serde(rename="Ø")]
    zero: Option<usize>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct S {
    n: String,
    t: usize,
    d_n: Option<String>,
}

#[derive(Deserialize, Debug)]
#[serde(rename_all="PascalCase")]
pub struct Dm0B {
    c: Vec<Value>,
    r: Option<usize>,
    #[serde(rename="Ø")]
    zero: Option<usize>,
}

#[derive(Deserialize, Debug)]
#[serde(untagged)]
pub enum Value {
    Str(String),
    Id(usize),
}

#[cfg(test)]
mod test {
    use super::*;

    const RESPONSE: &str = "{\"jobIds\":[\"e6c39045-0560-40d4-9bbc-f2047e4d4111\"],\"results\":[{\"jobId\":\"e6c39045-0560-40d4-9bbc-f2047e4d4111\",\"result\":{\"data\":{\"timestamp\":\"2021-03-04T16:25:59.326Z\",\"rootActivityId\":\"dda144bd-0337-4d29-ba38-2a755136b233\",\"descriptor\":{\"Select\":[{\"Kind\":1,\"Depth\":0,\"Value\":\"G0\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Unique Id\"},\"Calc\":\"G0\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Unique Id\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G1\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Command\"},\"Calc\":\"G1\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Command1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G2\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Last Name\"},\"Calc\":\"G2\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Last Name1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G3\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"First Name\"},\"Calc\":\"G3\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.First Name1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G4\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rank\"},\"Calc\":\"G4\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Rank1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G5\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Shield No\"},\"Calc\":\"G5\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.ShieldNo\"}],\"Expressions\":{\"Primary\":{\"Groupings\":[{\"Keys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Unique Id\"},\"Select\":0},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Command\"},\"Select\":1},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Last Name\"},\"Select\":2},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"First Name\"},\"Select\":3},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rank\"},\"Select\":4},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Shield No\"},\"Select\":5}],\"Member\":\"DM0\"}]}},\"Version\":2},\"fromCache\":true,\"dsr\":{\"Version\":2,\"MinorVersion\":1,\"DS\":[{\"N\":\"DS0\",\"PH\":[{\"DM0\":[{\"S\":[{\"N\":\"G0\",\"T\":1,\"DN\":\"D0\"},{\"N\":\"G1\",\"T\":1,\"DN\":\"D1\"},{\"N\":\"G2\",\"T\":1,\"DN\":\"D2\"},{\"N\":\"G3\",\"T\":1,\"DN\":\"D3\"},{\"N\":\"G4\",\"T\":1,\"DN\":\"D4\"},{\"N\":\"G5\",\"T\":1,\"DN\":\"D5\"}],\"C\":[0,0,0,0,0,0]},{\"C\":[1,1,1,1,1],\"R\":2},{\"C\":[2,2,2,0,2],\"R\":2},{\"C\":[3,3,3,3],\"R\":18},{\"C\":[4,4,4,4],\"R\":18},{\"C\":[5,5,5,2,5],\"R\":2},{\"C\":[6,6,6,1,6],\"R\":2},{\"C\":[7,7,7,7],\"R\":18},{\"C\":[8,8,8,3,8],\"R\":2},{\"C\":[9,9,9,1,9],\"R\":2},{\"C\":[10,10,10,0,10],\"R\":2},{\"C\":[11,11,11,1,11],\"R\":2},{\"C\":[12,12,12,0,12],\"R\":2},{\"C\":[13,13,13,1,13],\"R\":2},{\"C\":[14,14,14,14],\"R\":18},{\"C\":[15,15,15,0,15],\"R\":2},{\"C\":[16,16,16,16],\"R\":18},{\"C\":[17,17,17,17],\"R\":18},{\"C\":[18,1,18,18,18],\"R\":16},{\"C\":[19,19,19,19],\"R\":18},{\"C\":[20,20,20,20],\"R\":18},{\"C\":[21,21,21,2,5],\"R\":2},{\"C\":[22,22,22,0,21],\"R\":2},{\"C\":[23,23,18,22],\"R\":18},{\"C\":[24,24,23,23],\"R\":18},{\"C\":[25,25,24,24],\"R\":18},{\"C\":[26,26,25,3,25],\"R\":2},{\"C\":[27,27,26,0,26],\"R\":2},{\"C\":[28,28,21,27],\"R\":18},{\"C\":[29,29,18,28],\"R\":18},{\"C\":[30,30,27,29],\"R\":18},{\"C\":[31,31,28,30],\"R\":18},{\"C\":[32,32,21,2,5],\"R\":2},{\"C\":[33,33,0,31],\"R\":10},{\"C\":[34,34,29,3,32],\"R\":2},{\"C\":[35,35,30,0,33],\"R\":2},{\"C\":[36,36,31,34],\"R\":18},{\"C\":[37,37,4,35],\"R\":18},{\"C\":[38,38,26,36],\"R\":18},{\"C\":[39,39,32,37],\"R\":18},{\"C\":[40,40,18,38],\"R\":18},{\"C\":[41,41,33,39],\"R\":18},{\"C\":[42,42,34,3,40],\"R\":2},{\"C\":[43,43,35,0,41],\"R\":2},{\"C\":[44,44,11,42],\"R\":18},{\"C\":[45,45,27,43],\"R\":18},{\"C\":[46,46,3,44],\"R\":10},{\"C\":[47,47,36,0,45],\"R\":2},{\"C\":[48,48,37,2,5],\"R\":2},{\"C\":[49,49,38,0,46],\"R\":2},{\"C\":[50,50,39,47],\"R\":18},{\"C\":[51,51,40,48],\"R\":18},{\"C\":[52,52,41,49],\"R\":18},{\"C\":[53,53,42,3,50],\"R\":2},{\"C\":[54,54,27,0,51],\"R\":2},{\"C\":[55,55,43,52],\"R\":18},{\"C\":[56,56,27,53],\"R\":18},{\"C\":[57,57,25,54],\"R\":18},{\"C\":[58,58,44,55],\"R\":18},{\"C\":[59,59,27,3,56],\"R\":2},{\"C\":[60,60,45,0,57],\"R\":2},{\"C\":[61,61,46,58],\"R\":18},{\"C\":[62,62,27,59],\"R\":18},{\"C\":[63,63,18,3,60],\"R\":2},{\"C\":[64,64,47,0,61],\"R\":2},{\"C\":[65,65,18,62],\"R\":18},{\"C\":[66,66,48,63],\"R\":18},{\"C\":[67,67,27,3,64],\"R\":2},{\"C\":[68,68,46,0,65],\"R\":2},{\"C\":[69,69,49,3,66],\"R\":2},{\"C\":[70,70,50,0,67],\"R\":2},{\"C\":[71,0,68],\"R\":22},{\"C\":[72,71,51,69],\"R\":18},{\"C\":[73,72,52,70],\"R\":18},{\"C\":[74,73,53,71],\"R\":18},{\"C\":[75,74,54,72],\"R\":18},{\"C\":[76,75,44,73],\"R\":18},{\"C\":[77,76,55,74],\"R\":18},{\"C\":[78,77,56,75],\"R\":18},{\"C\":[79,78,57,76],\"R\":18},{\"C\":[80,79,58,77],\"R\":18},{\"C\":[81,80,35,78],\"R\":18},{\"C\":[82,81,59,79],\"R\":18},{\"C\":[83,82,21,80],\"R\":18},{\"C\":[84,83,60,81],\"R\":18},{\"C\":[85,84,61,3,82],\"R\":2},{\"C\":[86,85,35,0,83],\"R\":2},{\"C\":[87,86,62,84],\"R\":18},{\"C\":[88,87,63,85],\"R\":18},{\"C\":[89,88,18,86],\"R\":18},{\"C\":[90,64,87],\"R\":22},{\"C\":[91,89,61,88],\"R\":18},{\"C\":[92,90,21,89],\"R\":18},{\"C\":[93,91,65,90],\"R\":18},{\"C\":[94,92,66,91],\"R\":18},{\"C\":[95,93,67,92],\"R\":18},{\"C\":[96,94,68,93],\"R\":18},{\"C\":[97,95,69,94],\"R\":18},{\"C\":[98,96,70,95],\"R\":18},{\"C\":[99,97,61,96],\"R\":18},{\"C\":[\"000224\",98,71,97],\"R\":18},{\"C\":[\"000227\",99,72,3,98],\"R\":2},{\"C\":[\"000232\",\"Krol\",73,0,99],\"R\":2},{\"C\":[\"000238\",\"Lebloch\",18,\"23323\"],\"R\":18},{\"C\":[\"000239\",\"Lee\",74,\"12145\"],\"R\":18},{\"C\":[\"000240\",75,\"17395\"],\"R\":22},{\"C\":[\"000241\",76,2,5],\"R\":6},{\"C\":[\"000244\",\"Li\",77,0,\"17277\"],\"R\":2},{\"C\":[\"000245\",\"Lindo\",78,\"06482\"],\"R\":18},{\"C\":[\"000248\",\"Logan\",79,\"15993\"],\"R\":18},{\"C\":[\"000250\",\"Lopez\",80,\"25519\"],\"R\":18},{\"C\":[\"000251\",81,\"08017\"],\"R\":22},{\"C\":[\"000252\",26,\"08656\"],\"R\":22},{\"C\":[\"000257\",\"Maky\",82,\"11212\"],\"R\":18},{\"C\":[\"000259\",\"Mallon\",18,\"25507\"],\"R\":18},{\"C\":[\"000260\",\"Manfredi\",9,\"13211\"],\"R\":18},{\"C\":[\"000268\",\"Mcdougall\",83,\"00124\"],\"R\":18},{\"C\":[\"000269\",\"Mcgill\",84,\"24929\"],\"R\":18},{\"C\":[\"000275\",\"Meblin\",27,\"08367\"],\"R\":18},{\"C\":[\"000276\",\"Mele\",85,\"04939\"],\"R\":18},{\"C\":[\"000277\",\"Melendez\",86,\"27757\"],\"R\":18},{\"C\":[\"000278\",\"Menendez\",87,\"29787\"],\"R\":18},{\"C\":[\"000279\",\"Meyers\",5,\"04412\"],\"R\":18},{\"C\":[\"000281\",\"Milazzo\",18,\"06808\"],\"R\":18},{\"C\":[\"000282\",\"Milone\",21,\"03886\"],\"R\":18},{\"C\":[\"000285\",\"Moessner\",27,3,\"5417\"],\"R\":2},{\"C\":[\"000288\",\"Moran\",9,1,\"06810\"],\"R\":2},{\"C\":[\"000289\",\"Morrone\",88,0,\"17586\"],\"R\":2},{\"C\":[\"000292\",\"Motola\",26,\"19559\"],\"R\":18},{\"C\":[\"000294\",\"Mulligan\",89,\"05199\"],\"R\":18},{\"C\":[\"000298\",\"Naimoli\",90,\"26063\"],\"R\":18},{\"C\":[\"000299\",\"Narciso\",0,\"14021\"],\"R\":18},{\"C\":[\"000300\",\"Navarrete\",91,\"02936\"],\"R\":18},{\"C\":[\"000301\",\"Nelsen\",52,\"05268\"],\"R\":18},{\"C\":[\"000302\",\"Nethaway\",9,\"05879\"],\"R\":18},{\"C\":[\"000305\",\"Notaro\",92,\"29537\"],\"R\":18},{\"C\":[\"000306\",\"Ogando\",93,\"17119\"],\"R\":18},{\"C\":[\"000309\",\"Omara\",61,\"22299\"],\"R\":18},{\"C\":[\"000310\",\"Ortega\",94,\"18009\"],\"R\":18},{\"C\":[\"000312\",\"Outsen\",95,\"28444\"],\"R\":18},{\"C\":[\"000314\",\"Paniagua\",5,\"19985\"],\"R\":18},{\"C\":[\"000315\",\"Panton\",96,\"19487\"],\"R\":18},{\"C\":[\"000317\",\"Pasiecznik\",97,\"15540\"],\"R\":18},{\"C\":[\"000318\",\"Pastoriza\",36,\"14446\"],\"R\":18},{\"C\":[\"000320\",\"Pecak\",98,\"19339\"],\"R\":18},{\"C\":[\"000325\",\"Pizzolo\",99,\"03498\"],\"R\":18},{\"C\":[\"000327\",\"Poirier\",29,\"14947\"],\"R\":18},{\"C\":[\"000330\",\"Powe\",\"Jennifer\",\"12590\"],\"R\":18},{\"C\":[\"000333\",\"Rachwalski\",18,\"21717\"],\"R\":18},{\"C\":[\"000338\",\"Reese\",\"Jacy\",\"06264\"],\"R\":18},{\"C\":[\"000340\",\"Remouns\",\"Brandon\",\"26547\"],\"R\":18},{\"C\":[\"000342\",\"Reyes\",18,\"23266\"],\"R\":18},{\"C\":[\"000345\",\"Riddick\",\"Adam\",\"02676\"],\"R\":18},{\"C\":[\"000347\",\"Rivera\",\"Adriano\",3,\"03811\"],\"R\":2},{\"C\":[\"000348\",\"Rodriguez\",\"Alexis\",0,\"06766\"],\"R\":2},{\"C\":[\"000349\",\"Max\",\"13322\"],\"R\":22},{\"C\":[\"000350\",\"Rafael\",3,\"3275\"],\"R\":6},{\"C\":[\"000351\",\"Rooplal\",47,0,\"25894\"],\"R\":2},{\"C\":[\"000352\",\"Rosario\",\"Aramis\",\"24754\"],\"R\":18},{\"C\":[\"000355\",\"Rumaldo\",\"Nidio\",\"19359\"],\"R\":18},{\"C\":[\"000356\",\"Ruotolo\",\"Jessica\",\"00298\"],\"R\":18},{\"C\":[\"000361\",\"Santiago\",\"Oswaldo\",\"08022\"],\"R\":18},{\"C\":[\"000364\",\"Scaturro\",9,3,\"05166\"],\"R\":2},{\"C\":[\"000365\",\"Schlobohm\",\"Keith\",\"04156\"],\"R\":18},{\"C\":[\"000366\",\"Schmitt\",21,0,\"23020\"],\"R\":2},{\"C\":[\"000371\",\"Sclafani\",\"Anthony\",\"24799\"],\"R\":18},{\"C\":[\"000373\",\"Servius\",\"Jean\",\"11736\"],\"R\":18},{\"C\":[\"000374\",\"Shapiro\",46,\"12753\"],\"R\":18},{\"C\":[\"000375\",\"Sholomov\",\"Rafael\",\"22302\"],\"R\":18},{\"C\":[\"000378\",\"Simpson\",\"Audon\",\"08433\"],\"R\":18},{\"C\":[\"000380\",\"Skubisz\",\"Piotr\",\"22594\"],\"R\":18},{\"C\":[\"000382\",\"Smith\",54,\"13440\"],\"R\":18},{\"C\":[\"000383\",9,4,5],\"R\":6},{\"C\":[\"000384\",\"Solomon\",\"Max\",0,\"06994\"],\"R\":2},{\"C\":[\"000386\",\"Spaeth\",27,2,5],\"R\":2},{\"C\":[\"000390\",\"Sugranes\",21,0,\"12988\"],\"R\":2},{\"C\":[\"000394\",\"Tapia\",\"Cristian\",\"19428\"],\"R\":18},{\"C\":[\"000396\",\"Tasoren\",\"Arif\",\"31331\"],\"R\":18},{\"C\":[\"000398\",\"Terrett\",26,\"20643\"],\"R\":18},{\"C\":[\"000399\",\"Timchenko\",\"Karima\",\"00016\"],\"R\":18},{\"C\":[\"000400\",\"Tirro\",\"Luigi\",\"05819\"],\"R\":18},{\"C\":[\"000405\",\"Turco\",\"Louis\",2,5],\"R\":2},{\"C\":[\"000406\",\"Turner\",\"Chaz\",0,\"04587\"],\"R\":2},{\"C\":[\"000407\",\"Mark\",4,5],\"R\":6},{\"C\":[\"000408\",\"Tyrell\",\"Geronimo\",0,\"13283\"],\"R\":2},{\"C\":[\"000409\",\"Uske\",42,\"19422\"],\"R\":18},{\"C\":[\"000411\",\"Venetek\",35,\"10886\"],\"R\":18},{\"C\":[\"000415\",\"Vultaggio\",\"Benedict\",\"05121\"],\"R\":18},{\"C\":[\"000418\",\"Walcott\",\"Shatique\",\"02995\"],\"R\":18},{\"C\":[\"000421\",\"Washack\",\"Monika\",\"15689\"],\"R\":18},{\"C\":[\"000426\",\"Williams\",\"Jennifer\",\"02327\"],\"R\":18},{\"C\":[\"000429\",\"Wolfgang\",\"Ronald\",\"30705\"],\"R\":18},{\"C\":[\"000430\",\"Wong\",54,\"18848\"],\"R\":18},{\"C\":[\"000432\",\"Wu\",\"Wenming\",\"31370\"],\"R\":18},{\"C\":[\"000434\",\"Young\",\"Janae\",\"27922\"],\"R\":18},{\"C\":[\"000435\",\"Yovino\",\"Christina\",\"21333\"],\"R\":18},{\"C\":[\"000437\",2,\"Berrios\",\"Armando\",\"15168\"],\"R\":16},{\"C\":[\"000438\",\"Caballero\",\"Rodrigo\",1,\"02002\"],\"R\":2},{\"C\":[\"000440\",\"Depalma\",50,3,\"02400\"],\"R\":2},{\"C\":[\"000442\",\"Esparragoza\",11,1,\"04632\"],\"R\":2},{\"C\":[\"000443\",\"Espinal\",\"Vladimir\",0,\"22489\"],\"R\":2},{\"C\":[\"000445\",\"Fahmy\",18,1,\"01434\"],\"R\":2},{\"C\":[\"000452\",\"Lee\",35,\"01138\"],\"R\":18},{\"C\":[\"000454\",\"Liz\",\"Santos\",\"02656\"],\"R\":18},{\"C\":[\"000457\",\"Medina\",18,\"05283\"],\"R\":18},{\"C\":[\"000460\",\"Polizzi\",\"Sallyann\",\"2305\"],\"R\":18},{\"C\":[\"000461\",\"Porras\",11,0,\"08967\"],\"R\":2},{\"C\":[\"000463\",\"Reynolds\",\"Ronald\",3,\"05496\"],\"R\":2},{\"C\":[\"000466\",\"Roth\",27,0,\"27373\"],\"R\":2},{\"C\":[\"000469\",\"Smith\",18,1,\"3020\"],\"R\":2},{\"C\":[\"000474\",\"Zwilling\",\"Charles\",3,\"02777\"],\"R\":2},{\"C\":[\"000478\",3,\"Ali\",\"Jeremiah\",0,\"01195\"]},{\"C\":[\"000479\",\"Alkhafajee\",\"Shaimaa\",\"10584\"],\"R\":18},{\"C\":[\"000482\",\"Au\",27,\"11280\"],\"R\":18},{\"C\":[\"000483\",\"Aviles\",\"Francisco\",\"21271\"],\"R\":18},{\"C\":[\"000485\",\"Bailey\",61,2,5],\"R\":2},{\"C\":[\"000486\",\"Barbarelli\",\"Louis\"],\"R\":50},{\"C\":[\"000489\",\"Beban\",\"Helena\",0,\"00079\"],\"R\":2},{\"C\":[\"000490\",\"Belande\",\"Arland\",\"7494\"],\"R\":18},{\"C\":[\"000491\",\"Benedetto\",18,3,\"00827\"],\"R\":2},{\"C\":[\"000494\",\"Blaise\",\"Bryan\",0,\"24180\"],\"R\":2},{\"C\":[\"000500\",\"Bozzo\",21,\"13349\"],\"R\":18},{\"C\":[\"000502\",\"Buck\",\"Andrew\",\"15437\"],\"R\":18},{\"C\":[\"000507\",\"Camacho\",\"Robyn\",\"03387\"],\"R\":18},{\"C\":[\"000508\",\"Campaign\",72,\"142\"],\"R\":18},{\"C\":[\"000511\",\"Carlin\",35,\"11356\"],\"R\":18},{\"C\":[\"000514\",\"Castillo\",\"Rudy\",3,\"3487\"],\"R\":2},{\"C\":[\"000515\",\"Tamara\",0,\"26687\"],\"R\":6},{\"C\":[\"000516\",\"Ceballos\",\"Carlos\",\"29992\"],\"R\":18},{\"C\":[\"000517\",\"Cepero\",5,\"08820\"],\"R\":18},{\"C\":[\"000518\",47,\"Chim\",\"20989\"],\"R\":18},{\"C\":[\"000519\",27,3,\"03866\"],\"R\":6},{\"C\":[\"000520\",\"Eric\",0,\"26477\"],\"R\":6},{\"C\":[\"000521\",\"Randy\",\"25508\"],\"R\":22},{\"C\":[\"000523\",\"Chen\",\"Fu\",\"09658\"],\"R\":18},{\"C\":[\"000524\",\"Ray\",\"24263\"],\"R\":22},{\"C\":[\"000525\",\"Cheung\",\"Manko\",\"20825\"],\"R\":18},{\"C\":[\"000526\",\"Max\",\"19707\"],\"R\":22},{\"C\":[\"000527\",\"Vincent\",1,\"7096\"],\"R\":6},{\"C\":[\"000528\",\"Chien\",\"Helen\",0,\"00233\"],\"R\":2},{\"C\":[\"000533\",\"Chong\",54,1,\"4978\"],\"R\":2},{\"C\":[\"000535\",\"Chung\",\"Chester\",0,\"00997\"],\"R\":2},{\"C\":[\"000537\",\"Cooper\",\"Marlon\",\"12915\"],\"R\":18},{\"C\":[\"000540\",\"Coughlin\",52,\"20321\"],\"R\":18},{\"C\":[\"000543\",\"Cruz\",\"Alex\",\"29276\"],\"R\":18},{\"C\":[\"000545\",\"Cuesta\",\"Alexis\",\"00296\"],\"R\":18},{\"C\":[\"000546\",\"Cyrus\",\"Ian\",\"25427\"],\"R\":18},{\"C\":[\"000549\",\"Day\",9,3,\"01094\"],\"R\":2},{\"C\":[\"000552\",\"Dhundup\",\"Tsering\",0,\"29248\"],\"R\":2},{\"C\":[\"000553\",\"Dimanche\",\"Darnell\",\"22893\"],\"R\":18},{\"C\":[\"000556\",\"Dougherty\",\"Timothy\",\"17345\"],\"R\":18},{\"C\":[\"000558\",\"Duran\",\"Ariel\",\"26532\"],\"R\":18},{\"C\":[\"000559\",\"Edwin\",\"18925\"],\"R\":22},{\"C\":[\"000560\",\"Earley\",\"Timothy\",\"31190\"],\"R\":18},{\"C\":[\"000561\",\"Ellis\",\"Wayne\",\"20742\"],\"R\":18},{\"C\":[\"000562\",\"Eng\",\"Edmond\",\"16295\"],\"R\":18},{\"C\":[\"000564\",\"Faber\",59,\"16418\"],\"R\":18},{\"C\":[\"000569\",\"Franklin\",60,\"26479\"],\"R\":18},{\"C\":[\"000570\",\"Fraser\",\"Kwabena\",\"23820\"],\"R\":18},{\"C\":[\"000571\",\"Frazier\",\"Tyra\",\"12662\"],\"R\":18},{\"C\":[\"000572\",\"Frederic\",72,\"14964\"],\"R\":18},{\"C\":[\"000574\",\"Fu\",52,\"30339\"],\"R\":18},{\"C\":[\"000576\",\"Fung\",\"Johnny\",\"31739\"],\"R\":18},{\"C\":[\"000578\",\"Gannon\",5,\"13721\"],\"R\":18},{\"C\":[\"000582\",\"Giardino\",\"Brendan\",\"11681\"],\"R\":18},{\"C\":[\"000583\",\"Giarrantano\",\"Dominick\",3,\"04915\"],\"R\":2},{\"C\":[\"000585\",\"Gonzalez\",\"Edwin\",0,\"13640\"],\"R\":2},{\"C\":[\"000591\",\"Halbohn\",\"Dean\",\"17543\"],\"R\":18},{\"C\":[\"000594\",\"Hanak\",\"Stephani\",\"16920\"],\"R\":18},{\"C\":[\"000595\",\"Hardoman\",\"Tyrell\",3,\"2421\"],\"R\":2},{\"C\":[\"000602\",\"Huh\",\"Chungyoon\",4,5],\"R\":2},{\"C\":[\"000605\",\"Jalil\",\"Md\",0,\"22587\"],\"R\":2},{\"C\":[\"000608\",\"Javed\",\"Jawad\",3,\"4572\"],\"R\":2},{\"C\":[\"000609\",\"Jiang\",\"Hua\",0,\"13538\"],\"R\":2},{\"C\":[\"000610\",\"Joefield\",\"Stephon\",\"14719\"],\"R\":18},{\"C\":[\"000611\",94,\"Carl\",3,\"02719\"],\"R\":2},{\"C\":[\"000612\",\"Kaderjimenez\",\"Karen\",0,\"26765\"],\"R\":2},{\"C\":[\"000613\",\"Kang\",\"Dennis\",\"29955\"],\"R\":18},{\"C\":[\"000614\",\"Karshigiyev\",\"Mikhail\",\"06533\"],\"R\":18},{\"C\":[\"000616\",\"Kempinski\",\"Anthony\",\"26844\"],\"R\":18},{\"C\":[\"000617\",\"Kirkland\",\"Lamont\",\"15454\"],\"R\":18},{\"C\":[\"000620\",\"Kurys\",59,1,\"00845\"],\"R\":2},{\"C\":[\"000621\",\"Lai\",\"Chunho\",0,\"12520\"],\"R\":2},{\"C\":[\"000623\",\"Lau\",\"Joshua\",\"27732\"],\"R\":18},{\"C\":[\"000625\",\"Lee\",25,\"17467\"],\"R\":18},{\"C\":[\"000626\",\"Ming\",\"12796\"],\"R\":22},{\"C\":[\"000628\",\"Li\",\"Kim\",\"13537\"],\"R\":18},{\"C\":[\"000629\",\"Oscar\",\"25811\"],\"R\":22},{\"C\":[\"000630\",\"Lin\",\"Annie\",\"22626\"],\"R\":18},{\"C\":[\"000631\",\"Loeffel\",18,\"13292\"],\"R\":18},{\"C\":[\"000637\",\"Maqsood\",\"Kamal\",\"07418\"],\"R\":18},{\"C\":[\"000638\",\"Marcelino\",\"Emmanuel\",3,\"05095\"],\"R\":2},{\"C\":[\"000639\",\"Martinez\",\"Mairim\",\"02569\"],\"R\":18},{\"C\":[\"000640\",\"Matthis\",\"Shantell\",0,\"31883\"],\"R\":2},{\"C\":[\"000644\",\"Mckeefrey\",27,2,5],\"R\":2},{\"C\":[\"000646\",\"Mcneil\",4,0,\"28366\"],\"R\":2},{\"C\":[\"000647\",\"Mei\",62,\"12726\"],\"R\":18},{\"C\":[\"000648\",\"Merabe\",\"Faulkner\",\"07969\"],\"R\":18},{\"C\":[\"000651\",\"Montalban\",\"Jacqueline\",\"09945\"],\"R\":18},{\"C\":[\"000654\",\"Morell\",\"Huascar\",\"20809\"],\"R\":18},{\"C\":[\"000655\",\"Morelomaya\",\"Michelle\",\"09913\"],\"R\":18},{\"C\":[\"000656\",\"Morgan\",\"Casey\",2,5],\"R\":2},{\"C\":[\"000658\",\"Mottola\",\"Joel\",3,\"4982\"],\"R\":2},{\"C\":[\"000659\",\"Moy\",\"Seeyeung\",0,\"12018\"],\"R\":2},{\"C\":[\"000661\",\"Moyseidel\",\"Kimlee\",\"06436\"],\"R\":18},{\"C\":[\"000662\",\"Muhsin\",\"Ali\",\"06662\"],\"R\":18},{\"C\":[\"000664\",\"Ng\",\"Haklin\",2,5],\"R\":2},{\"C\":[\"000669\",\"Oconnell\",\"Anthony\",0,\"28219\"],\"R\":2},{\"C\":[\"000676\",\"Paulson\",\"Luke\",3,\"01896\"],\"R\":2},{\"C\":[\"000677\",\"Perez\",\"Margarita\",0,\"08584\"],\"R\":2},{\"C\":[\"000681\",\"Pleva\",\"Dyllan\",\"09422\"],\"R\":18},{\"C\":[\"000682\",\"Pong\",\"Wing\",\"22332\"],\"R\":18},{\"C\":[\"000683\",\"Poulsen\",18,\"24619\"],\"R\":18},{\"C\":[\"000684\",\"Poweska\",\"Monika\",\"20143\"],\"R\":18},{\"C\":[\"000690\",\"Raysor\",\"Brandon\",\"23650\"],\"R\":18},{\"C\":[\"000692\",\"Reeves\",26,\"30719\"],\"R\":18},{\"C\":[\"000698\",\"Rosado\",\"Rodney\",\"00858\"],\"R\":18},{\"C\":[\"000708\",\"Savic\",\"Nenad\",\"14725\"],\"R\":18},{\"C\":[\"000709\",\"Scharkopf\",97,\"02015\"],\"R\":18},{\"C\":[\"000712\",\"Searcy\",\"Calvin\",\"04349\"],\"R\":18},{\"C\":[\"000713\",\"Sezer\",\"Denise\",\"21860\"],\"R\":18},{\"C\":[\"000716\",\"Smith\",\"Shaneek\",\"30189\"],\"R\":18},{\"C\":[\"000718\",\"Soulier\",\"Adrien\",\"7196\"],\"R\":18},{\"C\":[\"000719\",\"Spano\",5,\"18773\"],\"R\":18},{\"C\":[\"000721\",\"Steele\",27,\"02361\"],\"R\":18},{\"C\":[\"000722\",\"Stevens\",\"Jarrell\",\"24536\"],\"R\":18},{\"C\":[\"000725\",\"Tejada\",\"Teodoro\",\"25055\"],\"R\":18},{\"C\":[\"000726\",\"Tong\",\"Chiho\",\"10292\"],\"R\":18},{\"C\":[\"000728\",\"Treanor\",21,\"20499\"],\"R\":18},{\"C\":[\"000731\",\"Urena\",87,\"13236\"],\"R\":18},{\"C\":[\"000732\",\"Valitutto\",\"Cassidy\",\"19188\"],\"R\":18},{\"C\":[\"000735\",\"Vedutis\",5,\"27030\"],\"R\":18},{\"C\":[\"000736\",\"Velazquez\",\"Lucian\",\"20683\"],\"R\":18},{\"C\":[\"000742\",\"Walker\",\"Claudia\",\"02553\"],\"R\":18},{\"C\":[\"000746\",\"Williams\",\"Jeffrey\",\"22854\"],\"R\":18},{\"C\":[\"000748\",\"Wong\",\"Henry\",\"03958\"],\"R\":18},{\"C\":[\"000752\",\"Wu\",\"Oscar\",\"17363\"],\"R\":18},{\"C\":[\"000753\",\"Wyszinski\",\"Lauren\",2,5],\"R\":2},{\"C\":[\"000754\",\"Yaroshevsky\",\"Alan\",0,\"13089\"],\"R\":2},{\"C\":[\"000758\",\"Yip\",\"Kakit\",3,\"00008\"],\"R\":2},{\"C\":[\"000759\",\"Yu\",\"Nelson\",0,\"15726\"],\"R\":2},{\"C\":[\"000760\",\"Shanta\",\"18097\"],\"R\":22},{\"C\":[\"000761\",\"Yung\",\"Kit\",3,\"05493\"],\"R\":2},{\"C\":[\"000762\",\"Zangrilli\",33,4,5],\"R\":2},{\"C\":[\"000763\",\"Zeng\",52,0,\"02889\"],\"R\":2},{\"C\":[\"000764\",\"Zhang\",\"Danny\",\"14836\"],\"R\":18},{\"C\":[\"000766\",\"Zheng\",\"Dongyun\",3,\"04228\"],\"R\":2},{\"C\":[\"000767\",\"Zhong\",\"Mao\",0,\"13301\"],\"R\":2},{\"C\":[\"000768\",\"Ziemkiewicz\",\"Ola\",\"12479\"],\"R\":18},{\"C\":[\"000771\",\"Zontini\",4,\"28669\"],\"R\":18},{\"C\":[\"000772\",\"Zuccaro\",26,\"15398\"],\"R\":18},{\"C\":[\"000778\",4,\"Colasuonno\",\"Leonard\",1,\"2054\"]},{\"C\":[\"000779\",\"Collarini\",18,0,\"00964\"],\"R\":2},{\"C\":[\"000780\",\"Dash\",\"Stanley\",1,\"03321\"],\"R\":2},{\"C\":[\"000783\",\"Donegan\",9,\"6625\"],\"R\":18},{\"C\":[\"000787\",\"Glas\",79,\"1407\"],\"R\":18},{\"C\":[\"000789\",\"Hickey\",52,\"06833\"],\"R\":18},{\"C\":[\"000792\",\"Longo\",21,3,\"01883\"],\"R\":2},{\"C\":[\"000797\",\"Montalvo\",\"Elvis\",1,\"478\"],\"R\":2},{\"C\":[\"000801\",\"Olsen\",5,0,\"25851\"],\"R\":2},{\"C\":[\"000802\",\"Perez\",\"Rafael\",\"13462\"],\"R\":18},{\"C\":[\"000805\",\"Saminath\",\"Dhanan\",3,\"04270\"],\"R\":2},{\"C\":[\"000807\",\"Soto\",\"Ruben\",\"00840\"],\"R\":18},{\"C\":[\"000809\",\"Stewart\",72,1,\"05347\"],\"R\":2},{\"C\":[\"000811\",\"Vandenburg\",4,0,\"04196\"],\"R\":2},{\"C\":[\"000812\",\"Virgilio\",26,\"24819\"],\"R\":18},{\"C\":[\"000818\",5,\"Agosto\",\"Jessica\",\"04383\"],\"R\":16},{\"C\":[\"000821\",\"Alese\",5,\"02255\"],\"R\":18},{\"C\":[\"000822\",\"Aloia\",\"Dennis\",\"00103\"],\"R\":18},{\"C\":[\"000823\",\"Alwi\",\"Gabrielle\",\"25245\"],\"R\":18},{\"C\":[\"000824\",\"Ambrecht\",\"Danielle\",\"17611\"],\"R\":18},{\"C\":[\"000825\",\"Amir\",\"Muhammad\",\"10773\"],\"R\":18},{\"C\":[\"000828\",\"Avellino\",\"Louis\",\"10394\"],\"R\":18},{\"C\":[\"000836\",\"Bedford\",\"Leroy\",1,\"01829\"],\"R\":2},{\"C\":[\"000840\",\"Borock\",\"Timothy\",0,\"13720\"],\"R\":2},{\"C\":[\"000841\",36,\"Kai\",2,5],\"R\":2},{\"C\":[\"000842\",\"Brand\",\"Eric\",0,\"18266\"],\"R\":2},{\"C\":[\"000850\",\"Burgos\",\"Nercy\",\"26131\"],\"R\":18},{\"C\":[\"000853\",\"Calandro\",26,3,\"04386\"],\"R\":2},{\"C\":[\"000854\",\"Cambria\",15,0,\"05589\"],\"R\":2},{\"C\":[\"000855\",\"Can\",\"Evrim\",\"19152\"],\"R\":18},{\"C\":[\"000856\",\"Carey\",\"Maureen\",\"20116\"],\"R\":18},{\"C\":[\"000859\",\"Casale\",18,3,\"5210\"],\"R\":2},{\"C\":[\"000861\",\"Chambertides\",54,\"04701\"],\"R\":18},{\"C\":[\"000862\",\"Champion\",5,0,\"05415\"],\"R\":2},{\"C\":[\"000863\",\"Cheung\",\"Kachun\",\"05890\"],\"R\":18},{\"C\":[\"000864\",51,27,\"06118\"],\"R\":18},{\"C\":[\"000869\",\"Connor\",\"Nolan\",\"20912\"],\"R\":18},{\"C\":[\"000870\",\"Contant\",61,\"09703\"],\"R\":18},{\"C\":[\"000872\",\"Cortorreal\",\"Ranfiel\",\"09248\"],\"R\":18},{\"C\":[\"000874\",\"Coughlin\",\"Brendan\",\"05537\"],\"R\":18},{\"C\":[\"000876\",\"Crespo\",\"Edan\",\"12927\"],\"R\":18},{\"C\":[\"000877\",\"Cristiano\",90,\"11366\"],\"R\":18},{\"C\":[\"000878\",\"Cronin\",9,\"08657\"],\"R\":18},{\"C\":[\"000880\",\"Cruz\",52,\"05612\"],\"R\":18},{\"C\":[\"000882\",\"Cuervo\",21,2,5],\"R\":2},{\"C\":[\"000883\",\"Darabant\",\"Ronald\",3,\"02842\"],\"R\":2},{\"C\":[\"000885\",\"Defonzo\",35,0,\"09791\"],\"R\":2},{\"C\":[\"000887\",\"Demes\",\"Yousef\",\"26487\"],\"R\":18},{\"C\":[\"000894\",\"Dones\",36,\"27390\"],\"R\":18},{\"C\":[\"000895\",\"Donggilio\",\"Jimmy\",3,\"02479\"],\"R\":2},{\"C\":[\"000896\",\"Douglas\",\"Nixon\",0,\"09711\"],\"R\":2},{\"C\":[\"000901\",\"Fabrizio\",\"Eric\",\"27211\"],\"R\":18},{\"C\":[\"000903\",\"Ferguson\",52,\"06843\"],\"R\":18},{\"C\":[\"000908\",\"Fontana\",\"Jackson\",\"11437\"],\"R\":18},{\"C\":[\"000909\",\"Gambina\",18,\"05499\"],\"R\":18},{\"C\":[\"000910\",6,52,\"00610\"],\"R\":18},{\"C\":[\"000913\",\"Garrison\",18,\"12124\"],\"R\":18},{\"C\":[\"000915\",\"Giersbach\",\"Gary\",2,5],\"R\":2},{\"C\":[\"000916\",\"Gnatowski\",\"Greg\",0,\"23753\"],\"R\":2},{\"C\":[\"000918\",\"Gondry\",\"Nicole\",3,\"01744\"],\"R\":2},{\"C\":[\"000919\",\"Gonzalez\",93,0,\"00463\"],\"R\":2},{\"C\":[\"000920\",\"Efrain\",\"26902\"],\"R\":22},{\"C\":[\"000922\",\"Grace\",9,\"01436\"],\"R\":18},{\"C\":[\"000923\",\"Grannum\",\"Bryan\",\"890\"],\"R\":18},{\"C\":[\"000924\",\"Grant\",\"Kenton\",\"05639\"],\"R\":18},{\"C\":[\"000925\",\"Malika\",\"28544\"],\"R\":22},{\"C\":[\"000933\",\"Hangas\",\"Sautania\",\"16657\"],\"R\":18},{\"C\":[\"000934\",\"Hardman\",52,\"04990\"],\"R\":18},{\"C\":[\"000935\",\"Harvey\",\"Octavier\",\"00459\"],\"R\":18},{\"C\":[\"000939\",\"Hendrick\",\"Tyler\",\"02811\"],\"R\":18},{\"C\":[\"000940\",\"Heredia\",29,\"20851\"],\"R\":18},{\"C\":[\"000945\",\"Houlahan\",27,3,\"00821\"],\"R\":2},{\"C\":[\"000948\",\"Irwin\",\"Bianca\",0,\"02049\"],\"R\":2},{\"C\":[\"000952\",\"James\",11,\"11580\"],\"R\":18},{\"C\":[\"000953\",\"Janison\",4,\"11873\"],\"R\":18},{\"C\":[\"000955\",\"Jones\",\"Brendan\",3,\"01471\"],\"R\":2},{\"C\":[\"000958\",\"Kaplon\",36,\"4609\"],\"R\":18},{\"C\":[\"000962\",\"Kim\",\"Kyong\",2,5],\"R\":2},{\"C\":[\"000965\",\"Kola\",\"Demetrios\",0,\"07439\"],\"R\":2},{\"C\":[\"000968\",\"Krasniqi\",\"Ilir\",\"08708\"],\"R\":18},{\"C\":[\"000973\",\"Lawrence\",\"Joshua\",\"08597\"],\"R\":18},{\"C\":[\"000975\",\"Lee\",80,\"06978\"],\"R\":18},{\"C\":[\"000977\",\"Victor\",\"12722\"],\"R\":22},{\"C\":[\"000978\",\"Legrange\",\"Brandice\",\"29355\"],\"R\":18},{\"C\":[\"000979\",\"Lewandowski\",9,3,\"03617\"],\"R\":2},{\"C\":[\"000980\",\"Li\",\"Cheung\",0,\"05474\"],\"R\":2},{\"C\":[\"000981\",\"Liandrakis\",\"Nikolaos\",\"14803\"],\"R\":18},{\"C\":[\"000987\",\"Maciag\",\"Marta\",\"11153\"],\"R\":18},{\"C\":[\"000988\",\"Maloney\",\"Martin\",3,\"01345\"],\"R\":2},{\"C\":[\"000989\",\"Mangual\",29,0,\"30450\"],\"R\":2},{\"C\":[\"000996\",\"Matos\",\"Mayko\",\"13660\"],\"R\":18},{\"C\":[\"000998\",\"Mcdevitt\",46,3,\"4967\"],\"R\":2},{\"C\":[\"000999\",\"Mcfall\",\"George\",0,\"00680\"],\"R\":2},{\"C\":[\"001004\",\"Miller\",60,\"19265\"],\"R\":18},{\"C\":[\"001006\",\"Montesdeoca\",\"Gustavo\",\"28875\"],\"R\":18},{\"C\":[\"001008\",\"Morales\",\"Anthony\",\"24585\"],\"R\":18},{\"C\":[\"001011\",\"Nelson\",\"Auda\",\"01636\"],\"R\":18},{\"C\":[\"001012\",\"Noftsier\",61,3,\"03020\"],\"R\":2},{\"C\":[\"001013\",\"Nolasco\",18,0,\"19280\"],\"R\":2},{\"C\":[\"001015\",\"Obrien\",61,\"18696\"],\"R\":18},{\"C\":[\"001016\",\"Oconnor\",\"Paula\",\"27143\"],\"R\":18},{\"C\":[\"001017\",\"Odekirk\",\"Charles\",\"16182\"],\"R\":18},{\"C\":[\"001020\",\"Olivares\",\"Claribel\",\"10631\"],\"R\":18},{\"C\":[\"001023\",\"Paezlopez\",36,\"26366\"],\"R\":18},{\"C\":[\"001024\",\"Perez\",\"Juan\",\"11514\"],\"R\":18},{\"C\":[\"001030\",\"Plessa\",54,\"16741\"],\"R\":18},{\"C\":[\"001032\",\"Poon\",\"Yan\",\"15400\"],\"R\":18},{\"C\":[\"001034\",\"Quinones\",72,\"27556\"],\"R\":18},{\"C\":[\"001036\",\"Rainero\",0,\"30940\"],\"R\":18},{\"C\":[\"001037\",\"Ramos\",\"Patricia\",\"24383\"],\"R\":18},{\"C\":[\"001039\",\"Re\",36,\"10902\"],\"R\":18},{\"C\":[\"001040\",\"Reade\",\"Nora\",\"21675\"],\"R\":18},{\"C\":[\"001048\",\"Rivera\",\"Paule\",\"15293\"],\"R\":18},{\"C\":[\"001049\",\"Roberts\",\"Shamari\",\"14926\"],\"R\":18},{\"C\":[\"001051\",\"Rodelli\",21,\"24009\"],\"R\":18},{\"C\":[\"001054\",\"Roserotapia\",\"Grace\",\"21698\"],\"R\":18},{\"C\":[\"001057\",\"Ruppert\",\"Bryan\",\"04243\"],\"R\":18},{\"C\":[\"001059\",\"Safatle\",21,\"18943\"],\"R\":18},{\"C\":[\"001061\",\"Sanders\",\"Joewel\",\"9172\"],\"R\":18},{\"C\":[\"001065\",\"Sapienza\",21,\"05222\"],\"R\":18},{\"C\":[\"001066\",\"Scagnelli\",60,\"14689\"],\"R\":18},{\"C\":[\"001072\",\"Sheehy\",9,\"02627\"],\"R\":18},{\"C\":[\"001073\",\"Shouldis\",60,\"16502\"],\"R\":18},{\"C\":[\"001076\",\"Simon\",\"Annalee\",\"24898\"],\"R\":18},{\"C\":[\"001078\",\"Smith\",\"Anthony\",\"23039\"],\"R\":18},{\"C\":[\"001079\",\"Sohmer\",14,\"20944\"],\"R\":18},{\"C\":[\"001083\",\"Spataro\",15,4,5],\"R\":2},{\"C\":[\"001084\",\"Sprague\",\"Allison\",3,\"00889\"],\"R\":2},{\"C\":[\"001087\",\"Starling\",\"Charles\",0,\"23775\"],\"R\":2},{\"C\":[\"001090\",\"Stopczyk\",\"Marek\",\"17171\"],\"R\":18},{\"C\":[\"001091\",\"Taraska\",18,\"13446\"],\"R\":18},{\"C\":[\"001092\",\"Tarnok\",\"Erik\",2,5],\"R\":2},{\"C\":[\"001093\",\"Taunton\",21,0,\"02629\"],\"R\":2},{\"C\":[\"001094\",\"Taybron\",\"Brandon\",2,5],\"R\":2},{\"C\":[\"001096\",\"Torres\",\"Israel\",0,\"20167\"],\"R\":2},{\"C\":[\"001104\",\"Vautrinot\",79,2,5],\"R\":2},{\"C\":[\"001107\",\"Vilaichit\",60,3,\"01668\"],\"R\":2},{\"C\":[\"001108\",\"Vincent\",21,0,\"23708\"],\"R\":2},{\"C\":[\"001112\",\"Weik\",60,\"26601\"],\"R\":18},{\"C\":[\"001113\",\"Williams\",\"Terence\",\"20982\"],\"R\":18},{\"C\":[\"001114\",\"Witt\",5,\"05922\"],\"R\":18},{\"C\":[\"001116\",\"Wu\",46,3,\"3652\"],\"R\":2},{\"C\":[\"001118\",6,\"Brinkley\",5,0,\"08168\"]},{\"C\":[\"001120\",\"Collado\",\"Juan\",\"06088\"],\"R\":18},{\"C\":[\"001121\",\"Crawford\",\"Jamel\",1,\"07706\"],\"R\":2},{\"C\":[\"001125\",\"Fauntleroy\",\"Blair\",0,\"28667\"],\"R\":2},{\"C\":[\"001126\",\"Galarza\",4,1,\"2104\"],\"R\":2},{\"C\":[\"001129\",\"Gnapi\",\"Narcisse\",\"07146\"],\"R\":18},{\"C\":[\"001133\",\"Isolano\",26,\"00545\"],\"R\":18}]}],\"IC\":false,\"RT\":[[\"'007 DET'\",\"'001133'\",\"'Isolano'\",\"'Nicholas'\",\"'Detective'\",\"'00545'\"]],\"ValueDicts\":{\"D0\":[\"000002\",\"000005\",\"000006\",\"000015\",\"000019\",\"000022\",\"000024\",\"000026\",\"000028\",\"000033\",\"000040\",\"000043\",\"000044\",\"000045\",\"000047\",\"000048\",\"000050\",\"000053\",\"000055\",\"000057\",\"000058\",\"000060\",\"000062\",\"000065\",\"000066\",\"000069\",\"000071\",\"000072\",\"000074\",\"000075\",\"000076\",\"000078\",\"000079\",\"000081\",\"000083\",\"000085\",\"000088\",\"000093\",\"000094\",\"000096\",\"000098\",\"000103\",\"000104\",\"000106\",\"000107\",\"000109\",\"000110\",\"000111\",\"000114\",\"000116\",\"000118\",\"000121\",\"000124\",\"000133\",\"000135\",\"000137\",\"000138\",\"000139\",\"000141\",\"000142\",\"000145\",\"000146\",\"000147\",\"000151\",\"000155\",\"000156\",\"000157\",\"000158\",\"000159\",\"000167\",\"000169\",\"000170\",\"000171\",\"000172\",\"000173\",\"000175\",\"000178\",\"000179\",\"000181\",\"000182\",\"000187\",\"000189\",\"000190\",\"000191\",\"000192\",\"000195\",\"000197\",\"000199\",\"000201\",\"000203\",\"000204\",\"000206\",\"000207\",\"000209\",\"000210\",\"000211\",\"000213\",\"000217\",\"000218\",\"000222\"],\"D1\":[\"001 DET\",\"001 PCT\",\"005 DET\",\"005 PCT\",\"006 DET\",\"006 PCT\",\"007 DET\"],\"D2\":[\"Accardi\",\"Bascom\",\"Bernabe\",\"Dicandia\",\"Eysel\",\"Friscia\",\"Garcia\",\"German\",\"Guerra\",\"Lazarus\",\"Menoni\",\"Okonek\",\"Ortiz\",\"Pelaez\",\"Rosello\",\"Russo\",\"Thomas\",\"Vitarelli\",\"Adelson\",\"Aguirre\",\"Ahmed\",\"Algerio\",\"Alonso\",\"Andrade\",\"Andrew\",\"Atallah\",\"Avdic\",\"Azzolino\",\"Barbella\",\"Baroz\",\"Barreto\",\"Bazelais\",\"Bello\",\"Bellomo\",\"Bianchini\",\"Bodden\",\"Bowen\",\"Brier\",\"Bruccoleri\",\"Bumbrey\",\"Burke\",\"Campbell\",\"Caraballo\",\"Carew\",\"Caro\",\"Castro\",\"Cawthorne\",\"Chan\",\"Cho\",\"Chowdhury\",\"Christofilakes\",\"Clark\",\"Cobaj\",\"Cummings\",\"Dabrowski\",\"Deforest\",\"Degaetano\",\"Delgiorno\",\"Dermody\",\"Desalvo\",\"Diaz\",\"Dileo\",\"Donadio\",\"Dunigan\",\"English\",\"Erdman\",\"Faulk\",\"Feldman\",\"Ferrara\",\"Flaiz\",\"Ford\",\"Francis\",\"Frawley\",\"Frolov\",\"Garda\",\"Geloso\",\"Giakoumis\",\"Giraldo\",\"Giugliano\",\"Griffin\",\"Gu\",\"Gut\",\"Gutierrez\",\"Habermehl\",\"Hart\",\"Hastings\",\"Hedge\",\"Hicks\",\"Holman\",\"Horan\",\"Hunsucker\",\"Iordanou\",\"Jean\",\"Jimenez\",\"Johnson\",\"Kain\",\"Kaiser\",\"Kemper\",\"Khan\",\"Knipper\"],\"D3\":[\"Richard\",\"Alistair\",\"Giocardo\",\"Ricardo\",\"Robert\",\"Christophe\",\"Edgar\",\"Antonio\",\"Annmarie\",\"Thomas\",\"Christian\",\"David\",\"Kharloz\",\"Fabian\",\"Kenneth\",\"Stephen\",\"Enoch\",\"Albert\",\"Michael\",\"Diego\",\"Shehroz\",\"Joseph\",\"Sarah\",\"Vinord\",\"Islam\",\"Alexander\",\"Nicholas\",\"Daniel\",\"Bradley\",\"Jason\",\"Dinah\",\"Tracy\",\"Deidra\",\"Paul\",\"Abraham\",\"Patrick\",\"Jonathan\",\"Byung\",\"Fiaz\",\"Vanessa\",\"Dillon\",\"Adrian\",\"Eugene\",\"Alana\",\"Donald\",\"Denys\",\"John\",\"Samantha\",\"Dorian\",\"Zachariah\",\"Francis\",\"Naja\",\"Brian\",\"Konstantin\",\"Peter\",\"Nick\",\"Alejandra\",\"Scott\",\"Kasiem\",\"Frank\",\"James\",\"Matthew\",\"Kevin\",\"Kaitlin\",\"Miles\",\"Nicolaos\",\"Serge\",\"Adriana\",\"Marvin\",\"Russell\",\"Kayla\",\"Sonia\",\"William\",\"Owen\",\"Ivin\",\"Jongbin\",\"Kengyan\",\"Benny\",\"Alexa\",\"Ryan\",\"Douglas\",\"Jesse\",\"Sharif\",\"Gerald\",\"Shaun\",\"Evan\",\"Illiana\",\"Enrique\",\"Gabriele\",\"Terrence\",\"Justin\",\"Jennica\",\"Ashley\",\"Angel\",\"Maritza\",\"Maxwell\",\"Dajon\",\"Gregory\",\"Gabriel\",\"Perry\"],\"D4\":[\"Police Officer\",\"Detective\",\"Lieutenant\",\"Sergeant\",\"Captain\"],\"D5\":[\"18377\",\"4557\",\"25607\",\"18015\",\"03057\",\"00000\",\"1609\",\"4066\",\"03142\",\"6837\",\"07576\",\"6203\",\"13130\",\"1890\",\"5403\",\"01734\",\"15108\",\"20154\",\"18821\",\"24483\",\"8188\",\"22154\",\"00114\",\"11378\",\"09034\",\"01089\",\"20550\",\"01728\",\"00265\",\"29988\",\"03820\",\"24336\",\"04743\",\"18500\",\"18506\",\"21510\",\"07749\",\"19331\",\"08036\",\"25364\",\"03921\",\"29910\",\"19012\",\"01441\",\"1183\",\"27708\",\"29244\",\"05179\",\"14663\",\"16761\",\"2341\",\"01813\",\"23535\",\"29293\",\"06759\",\"26830\",\"5063\",\"16170\",\"20071\",\"02592\",\"02985\",\"06200\",\"15729\",\"17174\",\"04022\",\"26745\",\"2387\",\"11105\",\"16174\",\"15604\",\"16325\",\"09170\",\"22317\",\"18858\",\"14298\",\"06313\",\"08110\",\"21347\",\"19651\",\"05662\",\"28570\",\"10461\",\"02674\",\"05770\",\"22427\",\"29273\",\"04728\",\"31489\",\"15001\",\"30785\",\"26854\",\"00756\",\"11492\",\"12307\",\"16039\",\"14261\",\"26705\",\"28698\",\"04616\",\"09220\"]}}]}}}}]}";

    const DETAILS: &str = "{\"jobIds\":[\"b58ea924-0e62-44ac-87c9-f41461352146\"],\"results\":[{\"jobId\":\"b58ea924-0e62-44ac-87c9-f41461352146\",\"result\":{\"data\":{\"timestamp\":\"2021-03-05T03:59:40.632Z\",\"rootActivityId\":\"113f6a96-ac8f-4177-b112-d766345683b2\",\"descriptor\":{\"Select\":[{\"Kind\":1,\"Depth\":0,\"Value\":\"G0\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rn\"},\"Calc\":\"G0\",\"IsSameAsSelect\":true}],\"Name\":\"Sum(Query1.Rn)\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G1\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Complaint ID\"},\"Calc\":\"G1\",\"IsSameAsSelect\":true}],\"Name\":\"CountNonNull(Query1.Complaint Id)1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G2\",\"Format\":\"MM/dd/yyyy\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Incident Date\"},\"Calc\":\"G2\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Incident Date\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G3\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"FADO Type\"},\"Calc\":\"G3\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.FADO Type1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G4\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Allegation\"},\"Calc\":\"G4\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Allegation1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G5\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Board Disposition\"},\"Calc\":\"G5\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.Board Disposition1\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G6\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"NYPD Disposition\"},\"Calc\":\"G6\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.NYPD Disposition\"},{\"Kind\":1,\"Depth\":0,\"Value\":\"G7\",\"GroupKeys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Penalty\"},\"Calc\":\"G7\",\"IsSameAsSelect\":true}],\"Name\":\"Query1.PenaltyDesc1\"}],\"Expressions\":{\"Primary\":{\"Groupings\":[{\"Keys\":[{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Rn\"},\"Select\":0},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Complaint ID\"},\"Select\":1},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Incident Date\"},\"Select\":2},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"FADO Type\"},\"Select\":3},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Allegation\"},\"Select\":4},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Board Disposition\"},\"Select\":5},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"NYPD Disposition\"},\"Select\":6},{\"Source\":{\"Entity\":\"CCRB Active - Oracle\",\"Property\":\"Penalty\"},\"Select\":7}],\"Member\":\"DM0\"}]}},\"Version\":2},\"fromCache\":false,\"dsr\":{\"Version\":2,\"MinorVersion\":1,\"DS\":[{\"N\":\"DS0\",\"PH\":[{\"DM0\":[{\"S\":[{\"N\":\"G0\",\"T\":3},{\"N\":\"G1\",\"T\":1,\"DN\":\"D0\"},{\"N\":\"G2\",\"T\":7},{\"N\":\"G3\",\"T\":1,\"DN\":\"D1\"},{\"N\":\"G4\",\"T\":1,\"DN\":\"D2\"},{\"N\":\"G5\",\"T\":1,\"DN\":\"D3\"},{\"N\":\"G6\",\"T\":1,\"DN\":\"D4\"},{\"N\":\"G7\",\"T\":1,\"DN\":\"D5\"}],\"C\":[1,0,1522713600000,0,0,0],\"Ø\":192},{\"C\":[2,1,1,0,0],\"R\":14},{\"C\":[3,2,2],\"R\":206},{\"C\":[4,3,0],\"R\":14,\"Ø\":192}]}],\"IC\":true,\"HAD\":true,\"ValueDicts\":{\"D0\":[\"201802628\"],\"D1\":[\"Abuse of Authority\"],\"D2\":[\"Vehicle stop\",\"Frisk\",\"Vehicle search\",\"Question\"],\"D3\":[\"Unsubstantiated\",\"Substantiated (Command Discipline B)\",\"Substantiated (Command Discipline A)\"],\"D4\":[\"Formalized Training\"],\"D5\":[\"Formalized Training\"]}}]}}}}]}";

    #[test]
    fn deserialize_response() {

        let model: Response = serde_json::from_str(RESPONSE).expect("deserialize");

        assert_eq!(model.results[0].result.data.descriptor.select[0].group_keys[0].source.entity, "CCRB Active - Oracle");
    }

    #[test]
    fn deserialize_details() {

        let model: Response = serde_json::from_str(DETAILS).expect("deserialize");

        assert_eq!(model.results[0].result.data.descriptor.select[0].group_keys[0].source.entity, "CCRB Active - Oracle");
    }
}

fn map_response(data: &Ds) -> Vec<Vec<String>> {
    let mut result = vec![];

    let value_dicts = match &data.value_dicts {
        None => return vec![],
        Some(v) => v,
    };

    let mut rows = data.p_h.get(0).expect("one row in PH").d_m0.iter();

    let first = rows.next().expect("first row in DM0");

    let (dicts, mut prev) = match first {
        Dm0::A(start) => {
            let dicts = start.s
                .iter()
                .map(|s| {
                    match s.t {
                        3 => {
                            let b: Box<dyn Fn(usize) -> String> = Box::new(|c: usize| c.to_string());
                            b
                        }
                        7 => {
                            // TODO: format date
                            let b: Box<dyn Fn(usize) -> String> = Box::new(|c: usize| c.to_string());
                            b
                        }
                        _ => {
                            let dict = value_dicts.get(s.d_n.as_ref().expect("value dict id")).expect("value dict");
                            let b: Box<dyn Fn(usize) -> String> = Box::new(move |c| dict[c].clone());
                            b
                        }
                    }
                })
                .collect::<Vec<Box<dyn Fn(usize) -> String>>>();

            let mut row = vec![];

            let mut items = start.c.iter();

            for i in 0..dicts.len() {
                let mask = start.zero.unwrap_or_default();
                let bit = 1 << i;
                if mask & bit == 0 {
                    let item = items.next().expect("not enough items");
                    row.push(dicts[i](*item));
                }
                else {
                    row.push("".into());
                }
            }

            (dicts, row)
        }
        _ => {
            eprintln!("Expected first row to have full spec");
            return vec![];
        }
    };

    result.push(prev.clone());

    for row in rows {
        let mut accum = prev.clone();

        match row {
            Dm0::B(next) => {
                let mask = next.r.unwrap_or_default();
                let mut values = next.c.iter();

                let zero = next.zero.unwrap_or_default();

                for i in 0..dicts.len() {
                    let bit = 1 << i;

                    if zero & bit != 0 {
                        accum[i] = "".into();
                    }
                    else if mask & bit == 0 {
                        let value = values.next().expect("not enough values");
                        accum[i] = match value {
                            Value::Str(s) => s.clone(),
                            Value::Id(j) => dicts[i](*j),
                        };
                    }
                }
            }
            _ => {
                eprintln!("Expected subsequent row to have differential");
                return result;
            }
        }

        result.push(accum.clone());
        prev = accum;
    }

    return result;
}
